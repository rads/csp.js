{"name":"CSP.js","tagline":"CSP for vanilla JavaScript.","body":"# CSP.js\r\n\r\nThis library provides CSP primitives for vanilla JavaScript. If you've used Clojure's [core.async](https://github.com/clojure/core.async) before, picking up CSP.js is easy.\r\n\r\nMuch thanks to the [contributors of core.async](https://github.com/clojure/core.async/graphs/contributors). Most of this library is a direct translation of core.async's Clojure code to JavaScript.\r\n\r\n## Example\r\n\r\nThis example can be found in [examples/search.js](https://github.com/rads/csp.js/blob/master/examples/search.js).\r\n\r\n    // This function simulates a search request to a remote source, such as an HTTP\r\n    // request to Google.\r\n    function fakeRemoteSearch(query) {\r\n      var latency = (Math.random() * 200);\r\n      return CSP.go(function*() {\r\n        yield CSP.take(CSP.timeout(latency));\r\n        return {query: query, latency: latency};\r\n      });\r\n    }\r\n\r\n    function performSearch(n) {\r\n      return CSP.go(function*() {\r\n        // Closes after 100 ms.\r\n        var timeout = CSP.timeout(100);\r\n        // Provides a value after 0-200 ms.\r\n        var search = fakeRemoteSearch('javascript ' + n);\r\n        // Choose whatever channel provides a value or closes first.\r\n        var result = yield CSP.alts([search, timeout]);\r\n\r\n        if (result.chan === search) {\r\n          return result.value;\r\n        } else {\r\n          return 'timeout';\r\n        }\r\n      });\r\n    }\r\n\r\n    // On average, half the searches will complete and half will time out.\r\n    CSP.go(function*() {\r\n      for (var i = 0; i < 10; i++) {\r\n        console.log(yield CSP.take(performSearch(i)));\r\n      }\r\n    });\r\n\r\n## Usage\r\n\r\nCSP.js requires ES6 generators, which are not supported in browsers or in Node 0.10.x or below. Firefox has built-in support only for an old version of generators which are not compatible with CSP.js.\r\n\r\nIf you want to use this library in the browser or any version of Node.js before 0.11.x, you'll have to compile your code with [Regenerator](https://github.com/facebook/regenerator) and include its runtime. For example, if you want to run the search example, you use it like this:\r\n\r\n    regenerator examples/search.js > examples/build/search.js\r\n\r\nYou also have to include the Regenerator runtime on the page somewhere. The runtime file is bundled with this repository as `regenerator.runtime.js` and `regenerator.runtime.min.js`. These are merely copies of the runtime files in the Regenerator repository. CSP.js has been tested with Regenerator version 0.2.10. In the end, your script tags look something like this:\r\n\r\n    <script src=\"regenerator.runtime.min.js\"></script>\r\n    <script src=\"csp.min.js\"></script>\r\n    <script src=\"examples/search.js\"></script>\r\n\r\nOf course, if you're using this library in production, you'll want to concatenate all those into a single file.\r\n\r\nIf you want to use this library in Node 0.11.x or above, you don't need any compilation or an extra runtime, but you do need to set a command-line option:\r\n\r\n    node --harmony-generators examples/search.js\r\n\r\n## API\r\n\r\nCSP.js is a faithful port of core.async in both API and implementation.\r\n\r\nDocumentation is still in-progress. For more details, check the [unit tests](https://github.com/rads/csp.js/blob/master/test/index_test.js) and [core.async API docs](http://clojure.github.io/core.async/) for now.\r\n\r\n### go(function*() { ... })\r\n\r\n### yield take(channel)\r\n\r\n### yield put(channel, value)\r\n\r\n### takeAsync(channel, value, onComplete)\r\n\r\n### putAsync(channel, value, onComplete)\r\n\r\n### close(channel)\r\n\r\n### timeout(duration)\r\n\r\n### pipe(from, to [, shouldClose])\r\n\r\n### mapPull(channel, fn)\r\n\r\n### mapPush(channel, fn)\r\n\r\n### map(channels, [bufOrN,] fn)\r\n\r\n### reduce(channel, init, fn)\r\n\r\n### merge(channel [, bufOrN])\r\n\r\n### intoArray(channel)\r\n\r\n### takeNum(channel, n [, bufOrN])\r\n\r\n### unique(channel [, bufOrN])\r\n\r\n### partition(channel, n [, bufOrN])\r\n\r\n### partitionBy(channel, [bufOrN,] fn)\r\n\r\n### filterPull(channel, [bufOrN,] fn)\r\n\r\n### filterPush(channel, fn)\r\n\r\n### removePull(channel, [bufOrN,] fn)\r\n\r\n### removePush(channel, fn)\r\n\r\n### mapcatPull(channel, [bufOrN,] fn)\r\n\r\n### mapcatPush(channel, [bufOrN,] fn)\r\n\r\n### split(channel, [passBufOrN, failBufOrN,] fn)\r\n\r\n### ontoChan(channel, array [, shouldClose])\r\n\r\n### toChan(array)\r\n\r\n## TODO\r\n\r\n- More documentation\r\n- More functions\r\n    - mult, tap, untap, untapAll\r\n    - mix, admix, unmix, unmixAll, toggle, soloMode\r\n    - pub, sub, unsub, unsubAll\r\n- Optimize for speed and file size\r\n- Test for compatibility in IE\r\n\r\n## License\r\n\r\nCSP.js is released under the [MIT License](http://www.opensource.org/licenses/MIT).\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}